PROCEDURE crea_excel IS
	-- variables de la hoja
	nfila NUMBER(10) := 4;
	ncol NUMBER(10) := 0;
	NUM_HOJA NUMBER := 0;
	-------------------------
	-- variables de datos
	d_fecha date := TRUNC(SYSDATE);
	-------------------------
	-- cursores
	CURSOR C_DATOS IS
		SELECT 'dato1' DATO, 10 NUMERO, 10.5 DECIMALL, 
					'ROJO' COLOR1, 'AZUL' COLOR2, 'VERDE' COLOR3, 'AMARILLO' COLOR4
		FROM DUAL
		WHERE TRUNC(SYSDATE) = d_fecha;
	-------------------------
	-- funciones
	FUNCTION GET_DATO RETURN VARCHAR2 IS
	BEGIN
		RETURN 'X';
	END;
	-------------------------
	-- procedimientos
	PROCEDURE IMPRIMIR_TITULOS(NFILA NUMBER) IS
		X_TAM_ARR NUMBER;
	BEGIN
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 1, 'DATO');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 2, 'NUMERO');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 3, 'DECIMAL');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 4, 'COLOR 1');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 5, 'COLOR 2');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 6, 'COLOR 3');
		DOC_EXCEL.SET_CELDA_TITULO(NFILA, 7, 'COLOR 4');
	END;
	-------------------------
BEGIN
	SET_APPLICATION_PROPERTY(CURSOR_STYLE, 'BUSY');
	
	-- INICIA EXCEL  / DEFINE NUMERO DE HOJA Y FILA DE INICIO
	DOC_EXCEL.INICIAR; 	NUM_HOJA := NUM_HOJA + 1;		nfila := 3;
	
	-- ABRIMOS LA NUEVA HOJA Y LE COLOCAMOS UN TITULO
	DOC_EXCEL.ABRIR_HOJA(NUM_HOJA, 'NOMBRE DE HOJA #1');
	--IMPRIMIMOS CELDA DE TITULO
	DOC_EXCEL.SET_CELDA_TITULO(1, 2, 'TITULO DE LA HOJA #1');
	-- IMPRIMIMOS LOS ENCABEZADOS DE LAS TABLAS EN EL EXCEL
	IMPRIMIR_TITULOS(nfila);
	
	FOR DATO IN C_DATOS LOOP
			nfila := nfila + 1;
			--INSERTAMOS CELDA (NFILA, COLUMNA, VALOR,  TIPO_DATO)
			DOC_EXCEL.SET_CELDA(nfila, 1,	DATO.DATO,			DOC_EXCEL.TEXTO);
			DOC_EXCEL.SET_CELDA(nfila, 2,	DATO.NUMERO,		DOC_EXCEL.NUMERO);
			DOC_EXCEL.SET_CELDA(nfila, 3,	DATO.DECIMALL,	DOC_EXCEL.DECIMALL);
			DOC_EXCEL.SET_CELDA_COLOR(nfila, 4,	DATO.COLOR1, 	DOC_EXCEL.TEXTO, 	DATO.COLOR1);
			DOC_EXCEL.SET_CELDA_COLOR(nfila, 5,	DATO.COLOR2, 	DOC_EXCEL.TEXTO, 	DATO.COLOR2);
			DOC_EXCEL.SET_CELDA_COLOR(nfila, 6,	DATO.COLOR3, 	DOC_EXCEL.TEXTO, 	DATO.COLOR3);
			DOC_EXCEL.SET_CELDA_COLOR(nfila, 7,	DATO.COLOR4, 	DOC_EXCEL.TEXTO, 	DATO.COLOR4);
	END LOOP;
	DOC_EXCEL.AUTOAJUSTAR;
	
	-- ABRIMOS LA NUEVA HOJA Y LE COLOCAMOS UN TITULO
	NUM_HOJA := NUM_HOJA + 1; nfila := 3;
	DOC_EXCEL.ABRIR_HOJA(NUM_HOJA, 'NOMBRE DE HOJA #2');
	DOC_EXCEL.SET_CELDA_TITULO(1, 2, 'TITULO DE LA HOJA #2');
	IMPRIMIR_TITULOS(nfila);
	FOR DATO IN C_DATOS LOOP
		nfila := nfila + 1;
		--INSERTAMOS CELDA (NFILA, COLUMNA, VALOR,  TIPO_DATO)
		DOC_EXCEL.SET_CELDA(nfila, 1,	DATO.DATO,			DOC_EXCEL.TEXTO);
		DOC_EXCEL.SET_CELDA(nfila, 2,	DATO.NUMERO,		DOC_EXCEL.NUMERO);
		DOC_EXCEL.SET_CELDA(nfila, 3,	DATO.DECIMALL,	DOC_EXCEL.DECIMALL);
		DOC_EXCEL.SET_CELDA_COLOR(nfila, 4,	DATO.COLOR1, 	DOC_EXCEL.TEXTO, 	DATO.COLOR1);
		DOC_EXCEL.SET_CELDA_COLOR(nfila, 5,	DATO.COLOR2, 	DOC_EXCEL.TEXTO, 	DATO.COLOR2);
		DOC_EXCEL.SET_CELDA_COLOR(nfila, 6,	DATO.COLOR3, 	DOC_EXCEL.TEXTO, 	DATO.COLOR3);
		DOC_EXCEL.SET_CELDA_COLOR(nfila, 7,	DATO.COLOR4, 	DOC_EXCEL.TEXTO, 	DATO.COLOR4);
	END LOOP;
	DOC_EXCEL.AUTOAJUSTAR;
	-- TERMINAMOS EXCEL
	DOC_EXCEL.CERRAR;
	
	SET_APPLICATION_PROPERTY(CURSOR_STYLE,'DEFAULT');
END;
